智慧树习题


1.【问答题】(25分)
考虑一个由 N 个节点组成的分布式系统，节点按照顺时针排列成一个环。1.在最坏情况下(即选举发起者是当前 ID 最大节点在环中的顺时针下一节点)，请给出达成一次共识所需的总消息数量(包含 Election 消息和 Elected 消息)并说明推导过程。2.若在选举过程中，系统发生了网络分区，导致环变成了两个互不相通的弧线，该算法的“活性(Liveness)会受到什么影响?

2.【问答题】(25分)
假设我们需要使用 Hadoop MapReduce 对以下两行文本数据进行单词计数统计。输入数据(Input Splits):
Split 1:`Hello Hadoop Hello
Split 2:`Hello World
请回答以下三个问题:1. Map 阶段输出: 假设系统启动了两个 Map 任务分别处理这两个 Split。请列出所有 Map 任务输出的中间键值对(格式示例:`<key,value>`
2.Reduce 阶段输入: 在进入 Reduce 函数之前，Hadoop 框架会自动执行 Shufle和 Sort。请列出传递给Reduce 函数的确切输入格式。假设只有一个 Reduce 任务。
3.逻辑优化: 如果现在的需求变更为“只统计以字母'H'开头的单词”，你认为这个过滤逻辑应该写在 Map 函数中还是 Reduce 函数中?请说明理由。


3.【问答题】(25分)
经典的两阶段提交(2PC)协议具有严重的“阻塞性(Blocking)”。
请详细描述:
1.在什么特定情况下，2PC的参与者会陷入“卡住(卡在决定点附近)”的状态?此时为什么参与者不能自行决定提交或回滚?
2.这种阻塞性对高可用系统(如电商支付系统)会带来什么负面影响?


4.【问答题】(25分)
在异步系统中实现线性一致性非常困难。ABD 协议通过“仲裁读写”提供了一种解决方案。1.在 ABD 协议的读取操作中，为什么除了第一轮的 Query(查询最高版本)，还必须包含第二轮的 Write-back(写回)操作?请描述一个如果不进行写回，可能违反线性一致性(即“读到旧值”)的场景。2.假设系统有 N=5 个副本，按照 ABD 协议，系统最多能容忍多少个副本发生崩溃而依然能提供线性一致的读写?

第一题
在分布式系统模型中，我们通常需要对“节点行为(Nodes)”和“网络行为(Network)”做出假设。
请简述崩溃停止(Crash-stop)模型与拜占庭(Bvzantine)模型的区别。为什么在拜占庭将军问题中，如果存在f个恶意节点，系统的总节点数至少需要 3f+1个才能达成一致?

第二题
假设 ClientA向 Server B 请求时间同步。ClientA发送请求的本地时间为T=10:00:00.100ServerB接收请求的本地时间为 1,=10:00:00.120ServerB发送响应的本地时间为2=10:00:00.130ClientA接收响应的本地时间为2=10:00:00.170
请根据 NTP 协议的算法计算:
1.网络往返延迟(Round-trip delay,δ)
2.ClientA应该将自己的时钟调整为多少?

第三题
系统中存三个进程 P1,P2,P3，各自维护一个 Lamport 计数器，初始值均为 0。
算法规则:
1. 本地/发送事件:计数器先自增(C, ← ℃,+1)，若是发送事件，消息携带更新后的 C,作为时间戳2.接收事件:进程接收到时间戳为 Imsg 的消息时，更新本地计数器 C¡← max(Ci,Imsg)+ 1。
系统按照以下顺序发生了六个事件，请计算各事件完成后的逻辑时钟值:
1. 事件 a:P 执行一次本地操作。
2. 事件 b:P 向 P 发送消息 m1。
3. 事件 c: P收到消息 m1(此时 P,尚未发生过其他事件)。 

第四题
系统有三个节点 P1,P2,P3，初始向量均为 [0,0,0]。
1. 事件 A:P 执行一次本地操作。
2. 事件 B:P 向 P 发送消息 m1。
3. 事件 C:P执行一次本地操作。
4. 事件 D:P接收来自 P 的消息 m1。
5. 事件 E:P向 P发送消息 m2。
6. 事件 F:P;接收来自 P,的消息。
问题: 
1. 请写出事件 D(P2接收) 和事件 F(P3接收) 完成后的对应节点的向量时间戳。 
2. 请判断事件A(在P1)和事件C(在P3)之间是“发生序(Happens-before)”关系还是“并发(Concurrent)”关系?
   

题目背景：系统中共有三个节点 $P_1, P_2, P_3$，它们使用因果多播 (Causal Broadcast) 协议进行通信。当前状态：接收节点（推测为 $P_3$，原文的“尸”很像 P3 的误识别）：当前的本地向量时间戳为 $V_{local} = [2, 0, 0]$。
事件发生：该节点收到了一条来自 $P_2$（原文的“P,”应为 P2）的消息 $m$。
消息详情：消息 $m$ 携带的向量时间戳为 $V_m = [2, 3, 0]$。
问题：根据因果多播的交付规则，接收节点（$P_3$）现在能否立即交付 (Deliver) 这条消息 $m$？请列出两个具体的判断条件进行验证。

第六题
在一个分布式数据库中，为了保证写的一致性(强一致性)，采用了仲裁(Quorum)机制。 
假设系统总共有 N=5 个副本节点。 
1.如果配置写仲裁W=2(即写入2个副本才算成功)，那么读仲裁 R至少需要设置为多少，才能保证每次读取都能读到最新的数据? 
2.如果我们希望系统最多能容忍2个节点同时发生故障(fail-stop)而不影响写入操作，那么W 至少应该设为多少?此时R为多少才能保证读写一致性?


